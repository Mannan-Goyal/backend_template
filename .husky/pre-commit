#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

echo "ğŸš€ Kicking off pre-commit checks: Code Styling, Linting, Type-checking, and Building. ğŸš€"

# Format code
yarn run format && git add . || 
(
    echo "âŒ Prettier Format Failed: ğŸ˜¬
Run \"yarn run format\", stage your changes, and try again. ğŸ‘¨â€ğŸ’»"
    exit 1
)

# Check Prettier Standards
yarn run format:check ||
(
    echo "âŒ Prettier Check Failed: ğŸ˜¬
Your code styling doesn't meet the project guidelines. 
Run \"yarn run format\", stage your changes, and try again. ğŸ‘¨â€ğŸ’»"
    exit 1
)

# Check ESLint Standards
yarn run lint ||
(
    echo "âŒ ESLint Check Failed: ğŸš¨
Your code contains lint errors or warnings.
Please fix them as indicated above, stage your changes, and try again. ğŸ› "
    exit 1
)

# Check TypeScript Types
yarn run type:check ||
(
    echo "âŒ TypeScript Type Check Failed: ğŸ“
Your code has type errors.
Fix them as outlined above, stage your changes, and try again. ğŸ§"
    exit 1
)

# Attempt to Build the Project
echo "ğŸ”¨ Running build check: Attempting to build the project. ğŸ—"

yarn run build ||
(
    echo "âŒ Build Failed: ğŸ’”
There was an error building the project.
Review the errors above, make the necessary adjustments, and try again. ğŸ¤”"
    exit 1
)

# If all checks pass, proceed with the commit
echo "âœ… All pre-commit checks passed! ğŸ‰
Your code is ready for the limelight. Proceeding with commit. ğŸš€"